!function(a,b,c,d){var e=c.template("table-rate-shipping-row-template"),f=a("#shipping_rates"),g=f.find("tbody.table_rates"),h={init:function(){f.on("change","#woocommerce_table_rate_calculation_type",this.onCalculationTypeChange).on("change",'select[name^="shipping_condition"]',this.onShippingConditionChange).on("change",'input[name^="shipping_abort["]',this.onShippingAbortChange).on("click","a.add-rate",this.onAddRate).on("click","a.remove",this.onRemoveRate).on("click","a.dupe",this.onDupeRate);var b=g.data("rates");a(b).each(function(a){var c=g.find(".table_rate").length;g.append(e({rate:b[a],index:c}))}),a('label[for="woocommerce_table_rate_handling_fee"], label[for="woocommerce_table_rate_max_cost"], label[for="woocommerce_table_rate_min_cost"]',f).each(function(b,c){a(c).data("o_label",a(c).text())}),a('#woocommerce_table_rate_calculation_type, select[name^="shipping_condition"], input[name^="shipping_abort["]',f).change(),g.sortable({items:"tr",cursor:"move",axis:"y",handle:"td",scrollSensitivity:40,helper:function(b,c){return c.children().each(function(){a(this).width(a(this).width())}),c.css("left","0"),c},start:function(a,b){b.item.css("background-color","#f6f6f6")},stop:function(a,b){b.item.removeAttr("style"),h.reindexRows()}}),a(document.body).on("change","#woocommerce_table_rate_calculation_type",function(){""===a(this).val()?a("#shipping_class_priorities").show():a("#shipping_class_priorities").hide()}),a("#woocommerce_table_rate_calculation_type").change()},onCalculationTypeChange:function(){var c=a(this).val();"item"==c?a("td.cost_per_item input").attr("disabled","disabled").addClass("disabled"):a("td.cost_per_item input").removeAttr("disabled").removeClass("disabled"),c?(a("#shipping_class_priorities").hide(),a("td.shipping_label, th.shipping_label").hide()):(a("#shipping_class_priorities").show(),a("td.shipping_label, th.shipping_label").show()),c||(a("#shipping_class_priorities span.description.per_order").show(),a("#shipping_class_priorities span.description.per_class").hide());var d=b.i18n.order;"item"==c?d=b.i18n.item:"line"==c?d=b.i18n.line_item:"class"==c&&(d=b.i18n["class"]),a('label[for="woocommerce_table_rate_handling_fee"], label[for="woocommerce_table_rate_max_cost"], label[for="woocommerce_table_rate_min_cost"]').each(function(b,c){var e=a(c).data("o_label");e=e.replace("[item]",d),a(c).text(e)})},onShippingConditionChange:function(){var b=a(this).val(),c=a(this).closest("tr");""==b?c.find('input[name^="shipping_min"], input[name^="shipping_max"]').val("").prop("disabled",!0).addClass("disabled"):c.find('input[name^="shipping_min"], input[name^="shipping_max"]').prop("disabled",!1).removeClass("disabled")},onShippingAbortChange:function(){var b=a(this).is(":checked"),c=a(this).closest("tr");b?(c.find("td.cost").hide(),c.find("td.abort_reason").show(),c.find('input[name^="shipping_per_item"], input[name^="shipping_cost_per_weight"], input[name^="shipping_cost_percent"], input[name^="shipping_cost"], input[name^="shipping_label"]').prop("disabled",!0).addClass("disabled")):(c.find("td.cost").show(),c.find("td.abort_reason").hide(),c.find('input[name^="shipping_per_item"], input[name^="shipping_cost_per_weight"], input[name^="shipping_cost_percent"], input[name^="shipping_cost"], input[name^="shipping_label"]').prop("disabled",!1).removeClass("disabled")),a("#woocommerce_table_rate_calculation_type").change()},onAddRate:function(b){b.preventDefault();var c=g,d=c.find(".table_rate").length;c.append(e({rate:{rate_id:"",rate_class:"",rate_condition:"",rate_min:"",rate_max:"",rate_priority:"",rate_abort:"",rate_abort_reason:"",rate_cost:"",rate_cost_per_item:"",rate_cost_per_weight_unit:"",rate_cost_percent:"",rate_label:""},index:d})),a('#woocommerce_table_rate_calculation_type, select[name^="shipping_condition"], input[name^="shipping_abort["]',f).change()},onRemoveRate:function(c){if(c.preventDefault(),confirm(b.i18n.delete_rates)){var e=[];g.find("tr td.check-column input:checked").each(function(b,c){var d=a(c).closest("tr.table_rate").find(".rate_id").val();e.push(d),a(c).closest("tr.table_rate").addClass("deleting")});var f={action:"woocommerce_table_rate_delete",rate_id:e,security:b.delete_rates_nonce};a.post(d,f,function(b){a("tr.deleting").fadeOut("300",function(){a(this).remove()})})}},onDupeRate:function(c){c.preventDefault(),confirm(b.i18n.dupe_rates)&&(g.find("tr td.check-column input:checked").each(function(b,c){var d=a(c).closest("tr").clone();d.find(".rate_id").val("0"),g.append(d)}),h.reindexRows())},reindexRows:function(){var b=0;g.find("tr").each(function(c,d){a("input.text, input.checkbox, select.select",d).each(function(c,d){var e=a(d);e.attr("name",e.attr("name").replace(/\[([^[]*)\]/,"["+b+"]"))}),b++})}};h.init()}(jQuery,woocommerce_shipping_table_rate_rows,wp,ajaxurl);